# 2019年年终总结

  - 完善用户手册
  - 分析、实现oto8窗口记忆功能。
  - oto8窗口最大化按钮、双击窗口caption进入Fullscreen模式，修改为在Freeform模式下缩放到全屏
  - oto8窗口记忆功能代码合并，存在问题：应用启动打开，会判断是否遮挡已存在窗口，如果遮挡，应用无法打开，正考察解决方案
  - 测试，提交oto8窗口记忆功能
  - oto8窗口最大化按钮、双击窗口caption进入Fullscreen模式，修改为在Freeform模式下缩放到全屏
  - oto8窗口增加全屏按钮
  - oto8窗口最大化时，拖动窗口，窗口还原之前窗口化大小
  - oto2：设置-无障碍里的"Pico TTS"需屏蔽
  - oto8窗口标题栏自动隐藏功能
  - oto2最新版微信聊天界面空白bug
  - oto8窗口状态记录，包括最大化，全屏，左右停靠
  - oto8窗口修复左右停靠时，横竖切换按钮隐藏不显示
  - 分析oto8 狂野飙车8、央视影音、佳能打印打开闪退
  - oto8：最大化窗口后再以桌面模式重启，窗口会没有标题栏；
  - oto8：最大化窗口后鼠标移到屏幕最上方拖动，窗口会没有标题栏；
  - oto8：鼠标在窗口外较远的地方仍然可以拖动窗口
  - oto8：根据新的ui设计，修改decorcaption布局；
  - 首次配置，权限管理器设计文档；
  - 完善多窗口-DecorCaption设计文档；
  - bug：oto8桌面可以缩放；
  - oto8：与苗德行配合完成相机权限动态管理选择物理、虚拟摄像头功能；
  - oto8：分析实现多窗口应用强制手机模式运行。
  - 窗口DecorCaption的UI重构
  - 应用兼容模式（普通模式、全屏模式）切换功能
  - 调研分析，应用通过Resources资源获取屏幕信息的流程，并尝试截获、位置返回的屏幕信息。
  - 通过设计兼容性ContextImpl（NewContextImpl，继承ContextImpl）实现类，重写ContextImpl的createAppContext、createActivityContext、getResources方法，拦截、伪装Resources持有的DisplayMetrics数据，并在Resources的updateConfiguration方法内拦截DisplayMetrics更新，实现对Resources资源持有的屏幕信息截获、伪装。
  - 分析微信在强制手机竖屏模式下运行，朋友圈图片无法满铺窗口显示的问题，定位到是由于伪装的densityDpi与Bitmap持有的density两者不一致导致的，只是让两者保持一直，微信此问题可以解决，但对于有些应用需求，两者可能需要不一致。所以初步的解决方案是特殊应用特殊处理。
  - 应用窗口在普通模式、全屏模式、强制手机模式（横、竖屏）之间切换已实现完成
  - 应用窗口在强制手机模式（横、竖屏）模式下时，窗口禁止缩放，以及窗口拖动到屏幕顶部、左右两侧时，禁止停靠。
  - 窗口最大化按钮只有在普通模式下可见。
  - 系统应用窗口，只提供普通模式、全屏模式功能切换，第三方应用提供四种功能模式切换。
  - 兼容模式切换时，应用需要关闭，重新打开，且关闭时，应用进程关闭，并从最近列表中清除应用信息。
  - 修改应用窗口默认打开样式：系统应用默认打开桌面样式，第三方应用默认打开手机样式。
  - 测试、分析微信（7.0.3）小程序界面在兼容模式下不显示内容问题：测试发现标准模式下，修改系统分辨率后，微信小程序界面同样不显示内容；微信（7.0.4版本）此问题不存在。
  - 测试、分析微信版本7.0.3与7.0.4对窗口显示密度的处理存在差异，7.0.3版本微信只获取系统提供的屏幕数据来渲染内容，而7.0.4版本微信是根据系统提供的屏幕数据，重新计算一套新的适配微信窗口内容的屏幕数据，来渲染内容。对于微信7.0.4兼容运行模式，需要设计更合理的兼容运行模式实现方案。
  - oto8手机兼容模式切换，优化之前模式切换时停止应用进程，清除最近列表实现，修改模式切换时强制停止当前应用，再次打开应用时，模式生效。
  - oto8手机兼容模式，优化应用运行模式存储方式，在AMS中增加Hashmap，通过应用packageName、运行模式键值对形式存储应用的运行模式，同时在运行模式发生变化是，更新Hashmap表信息，并存储序列化Hashmap表到系统数据库中，在系统关机重启时，AMS服务启动时，反序列化Hashmap表，用于判断createAppContext创建兼容模式NewContextImpl还是标准模式ContextImpl。
  - bug：全屏模式只能通过开始菜单启动才有效，命令行、桌面图标和应用商店启动全屏模式的应用均为窗口大小。
  - bug：部分应用强制横竖屏模式时标题栏按钮偏移严重（例如：影梭、wps邮箱的查看邮件页面、愤怒的小鸟进入游戏时、buttons and scissors进入游戏时、微博）
  - oto8手机兼容模式技术交流汇报。
  - 整理oto8手机兼容模式相关API函数列表。
  - 分析oto8微信7.0.5聊天界面，右上角弹窗位置错位问题
  - 解决bug：京东、唯品会等部分应用模式切换提示框显示不全问题。
  - bug：分析、整理微信登录按钮重叠解决方案。
  - 分析oto8微信，editor长按内容，光标位置错位，以及文本编辑功能弹窗位置错乱bug。
  - bug：学堂在线横屏播放视频显示不完整
  - bug：微信（705）聊天页面文本输入框长按文字没有菜单（只有窗口在屏幕左上方的情况下才有
  - bug：微信（705）聊天页面文本输入框右键菜单跑偏
  - bug：微信（705）超过两行的聊天消息长按不弹出菜单
  - 调试、整理oto8微信登录按钮重叠bug的解决方案
  - review、整理oto8手机兼容模式需求功能代码，并push至服务器
  - 协助通过demo对比oto8、华为m6，返回给应用的相关多窗口的屏幕数据。
  - 协助解决oto8鼠标滚轮问题（bug1：滚轮滚动到底部会回弹；bug2：文件管理器文件多于一屏，不能顺利打击文件）
  - 协助分析、实现app在兼容模式下运行，建立CompatContextImpl，Display之间联系
  - bug：全屏时，鼠标移到顶部的右半部分的不会触发标题栏
  - bug：Microsoft office全屏时所有需要弹出子菜单的功能均不可用，比如修改字体颜色等
  - bug：安装应用时最小化安装窗口会使系统软重启，安装抖音时最容易复现
  - bug：蓝牙匹配时，鼠标点击弹出的匹配窗口，窗口会到桌面下方而无法点击
  - bug：时钟计时器功能完成计时后崩溃
  - 协助分析oto8通知栏实现流程，解决通知栏收到消息后，整体弹出问题。
  - 分析oto8系统语言显示流程，并协助修改
  - 同步aosp9.0、aosp10.0源码。
  - 编译aosp9.0源码，且成功运行在x86模拟器上。
  - aosp9.0上移植StartupMenu、StatusBar模块。
  - 分析、解决oto8微信欢乐斗地主、人人斗地主打开闪退问题。
  - 分析、解决oto8 office编辑菜单在窗口高度与设备高度一致时，无法显示问题。
  - 整理oto8 frameworks、base已提交的patches
  - 编译aosp8.1-r65分支源码，编译成功后，commit openthos8.1上frameworks/base下修改的所有patches，编译x86镜像运行在x86模拟器上，此部分工作已完成，用于多窗口测试平台。
  - 完成aosp9.0窗口在屏幕上侧、左侧、右侧docked及undocked功能。
  - 解决aosp9.0命令行启动应用及桌面应用默认打开非窗口化问题
  - 完成aosp9.0窗口bounds记忆功能，其中窗口docked状态、窗口全屏状态未记忆、系统关机重启后窗口各状态未记忆。
  - 完成Pixel C设备aosp8.1系统刷机。
  - 解决Pixel C设备aosp8.1系统wifi无法使用，窗口最小化无法还原问题。
  - 完成Pixel C设备aosp8.1系统应用兼容模式窗口尺寸适配。
  - 添加最大化功能到aosp9.0
  - 修改aosp9.0多窗口模式下，launcher始终显示在窗口最底层。
  - bug：aosp9.0默认窗口全屏功能，窗口内容无法实现全屏。通过对比分析aosp9.0、aosp10.0窗口全屏功能实现流程，定位到与ConfigurationContainer的mOverrideConfiguration的update、Changed有关，解决方案可以参考aosp8、aosp10实现思路。
  - 移植taskbaricon主体内容到aosp9.0
  - 移植taskbarIcon对应的接口和功能到aosp9.0
  - 修改窗口DecorCaption界面，增加back、appname、appicon、setting、minimize组件，同时添加对应功能接口
  - 移植最小化功能到aosp9.0.
  - 完成aosp9窗口docked状态、窗口全屏状态记忆、系统关机重启后窗口各状态记忆。
  - 解决aosp9 应用最小化，桌面获得焦点时，任务栏显示filemanager图标bug。
  - 解决aosp9 应用最小化，桌面获取焦点后，点击已最小化的应用，应用无法显示问题
  - bug：aosp9 StartupMenu点击uninstall应用时无反应。已可以显示uninstall应用界面，但无法点击。
  - 解决aosp9 install 或者uninstall应用时，系统软重启问题。
  - 解决aosp9 窗口Fullscreen时，隐藏maximize button。
  - 解决aosp9 真机运行时，最小化应用无法还原问题。
  - 提供Android8\9\10等版本系统运行截图，协助准备os2atc会议技术文档。
  - 解决aosp9 StartupMenu uninstall应用时，卸载界面无法点击问题。
  - 测试Deepin Cloud sync、OneDrive需求功能，并协助完成与openthos 云功能对比文档。
  - 整理云服务各种同步异常处理
  - 整理云服务概要设计文档修订版
  - 初步实现aosp9.0 应用兼容模式UI，以及标准模式、全屏模式运行模式切换。
  
95个功能、bug

  
  
  
